# Report

First let's start with what done. 
My strategy was to build something working end to end, and then 
iterate. Most of time I spent on solving data loading problem. 

The current flow looks like this:

For data loading I use:
- https://github.com/robolyst/streetview (for getting info about nearest pano, and downloading pano images)
- https://github.com/sk-zk/streetlevel (for getting metadata about panorama and links to other panoramas)

For now GeoGuessrWorldEnv receives only an input_lat and input_lon instead of a geofence. 
First, I use `streetview` to find the closest panorama and cache the mapping between the coordinates and the panorama ID. 
Next, I use `streetlevel` to retrieve metadata for that panorama, including links to adjacent ones. 
I then initiate a Breadth-First Search (BFS) to download and cache the metadata for a fixed number of panoramas (that number should be configurable in future).
Finally, I use streetview again to get the panorama images.

Important note is that both `streetview` and `streetlevel` are not use Google Street API for getting data,
but instead use calls to google maps site, which could be blocked by Google if used excessively.

After the data is loaded in `reset`, I build a graph of panoramas that are connected to each other. 


Things to improve:
- Revisit logic of placing links centers on the image, the relative position of links from metadata are corresponded 
  to ground truth, but I am not sure if I use the right heading to place the link. (As an alternative, I could 
  ignore directions from the metadata, and compute the right positions based on pano heading and coordinates myself).
- Revisit logic of click handling, currently it takes into account absolute distance on the image in the first place, 
  which is not correct in the case of equirectangular images and does not correspond to the task description.
- Abstract the cache logic into cache manager, and ability to store data not only in local filesystem,
  but also in S3 like storages.
- Build proper VLMBroker, right now OpenAIVisionAgent generated by Cursor, and should be **totally rewritten**.
- Add functionality to sample `(lat, lon)` from a seeded RNG within a configurable geofence.
- Add session reply functionality, and offline mode to work.
- Align with task description for env parameters: make `provider`, `obs_size`, `max_steps configurable`.
- For production use we can consider reimplementing data loading logic, to use API key, and also take
  `rate_limit_qps`, `max_fetch_retries`, `min_capture_year` into account.
- 